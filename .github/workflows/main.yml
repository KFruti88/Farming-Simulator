name: G-Portal Live Sync

on:
  schedule:
    - cron: '*/30 * * * *' # Runs every 30 minutes
  workflow_dispatch:      # Manual trigger button in GitHub Actions

jobs:
  sync:
    runs-on: ubuntu-latest
    steps:
      - name: ğŸ›°ï¸ Checkout Repository
        uses: actions/checkout@v3

      - name: ğŸšœ Sync XML from G-Portal
        uses: SamKirkland/FTP-Deploy-Action@v4.3.4
        with:
          server: ${{ secrets.FTP_SERVER }}
          username: ${{ secrets.FTP_USERNAME }}
          password: ${{ secrets.FTP_PASSWORD }}
          port: 50021 # Specific G-Portal Port
          # Adjust server-dir to where your save folders (saved-game-5, etc) are located
          server-dir: /
          local-dir: ./
          method: ftp
          dangerous-clean-slate: false

      - name: ğŸ“ Commit and Push Updates
        run: |
          git config --global user.name "GitHub Action"
          git config --global user.email "action@github.com"
          git add .
          git commit -m "Automated Sync: G-Portal Live Stats Update" || exit 0
          git push
