<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ray's FS22 Trophies</title>
    <style>
        :root {
            --glass: rgba(255, 255, 255, 0.1);
            --gold: #ffd700;
            --alert-orange: #ff4500;
            --text: #ffffff;
        }

        body {
            background: transparent;
            font-family: 'Inter', sans-serif;
            color: var(--text);
            margin: 0;
            padding: 10px;
        }

        #trophyList {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 12px;
        }

        .trophy-item {
            background: rgba(0, 0, 0, 0.6);
            padding: 12px;
            border-radius: 6px;
            border-left: 4px solid #444;
            backdrop-filter: blur(5px);
            display: flex;
            flex-direction: column;
        }

        /* Unearned styling (Pushed to top) */
        .trophy-item.unearned {
            border-left: 4px solid var(--alert-orange);
            background: rgba(255, 69, 0, 0.15);
            order: -1;
        }

        .trophy-item.earned {
            border-left: 4px solid #00ff00;
            opacity: 0.6;
            order: 1;
        }

        .trophy-title {
            font-weight: 900;
            font-size: 0.9em;
            text-transform: uppercase;
            color: var(--gold);
        }

        .trophy-status {
            font-size: 0.75em;
            font-weight: 700;
            margin-top: 5px;
            letter-spacing: 1px;
        }

        .unearned .trophy-status { color: var(--alert-orange); }
        .earned .trophy-status { color: #00ff00; }
    </style>
</head>
<body>

<div id="trophyList">UPLINKING TO PSN DATA STREAM...</div>

<script>
    async function syncTrophies() {
        const rssUrl = 'https://psntrophyleaders.com/user/view/OneLIVIDMAN/rss';
        // AllOrigins proxy handles the CORS bypass for GitHub Pages
        const proxyUrl = `https://api.allorigins.win/get?url=${encodeURIComponent(rssUrl)}`;

        try {
            const response = await fetch(proxyUrl);
            const data = await response.json();
            
            // Convert the raw string content into a searchable XML document
            const parser = new DOMParser();
            const xmlDoc = parser.parseFromString(data.contents, "text/xml");
            const items = Array.from(xmlDoc.querySelectorAll("item"));
            
            const listContainer = document.getElementById('trophyList');
            listContainer.innerHTML = '';

            // Filter specifically for Farming Simulator 22
            const fs22Trophies = items.filter(item => 
                item.querySelector("title").textContent.includes("Farming Simulator 22")
            );

            if (fs22Trophies.length === 0) {
                listContainer.innerHTML = "NO FS22 TELEMETRY DETECTED IN FEED.";
                return;
            }

            fs22Trophies.forEach(item => {
                const fullTitle = item.querySelector("title").textContent;
                const cleanTitle = fullTitle.split(" - ").pop();
                const description = item.querySelector("description").textContent;
                
                // Identify unearned trophies by checking if the "Earned on" date is missing
                const isEarned = description.toLowerCase().includes("earned on");
                
                const div = document.createElement('div');
                div.className = `trophy-item ${isEarned ? 'earned' : 'unearned'}`;
                
                div.innerHTML = `
                    <span class="trophy-title">${cleanTitle}</span>
                    <span class="trophy-status">${isEarned ? 'DATA SECURED' : 'PENDING ACQUISITION'}</span>
                `;
                listContainer.appendChild(div);
            });
        } catch (error) {
            document.getElementById('trophyList').innerHTML = "ERROR: PSN UPLINK INTERRUPTED.";
            console.error("Telemetry Sync Error:", error);
        }
    }

    // Initialize sync on load
    syncTrophies();
</script>

</body>
</html>
